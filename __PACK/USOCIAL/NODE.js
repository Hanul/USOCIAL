USOCIAL.FACEBOOK_ACCESS_TOKEN=METHOD({run:(e,t)=>{let o,n=e.redirectURI,r=e.code;GET({isSecure:!0,host:"graph.facebook.com",uri:"v2.3/oauth/access_token",paramStr:o="client_id="+encodeURIComponent(NODE_CONFIG.USOCIAL.Facebook.clientId)+"&redirect_uri="+encodeURIComponent(n)+"&client_secret="+encodeURIComponent(NODE_CONFIG.USOCIAL.Facebook.clientSecret)+"&code="+encodeURIComponent(r)},e=>{t(PARSE_STR(e))})}}),USOCIAL.FACEBOOK_GET_USER_DATA=METHOD({run:(e,t)=>{let o,n;CHECK_IS_DATA(e)!==!0?n=e:(o=params.userId,n=params.accessToken),GET({isSecure:!0,host:"graph.facebook.com",uri:"/v2.7/"+(void 0===o?"me":o)+"/friends",paramStr:"access_token="+n},e=>{let o=PARSE_STR(e);void 0!==o&&t(o.data)})}}),USOCIAL.FACEBOOK_GET_USER_DATA=METHOD({run:(e,t)=>{let o=e.userId,n=e.fields,r=e.accessToken,c="";EACH(n,(e,t)=>{t>0&&(c+=","),c+=e}),GET({isSecure:!0,host:"graph.facebook.com",uri:"/v2.7/"+(void 0===o?"me":o),paramStr:"fields="+c+"&access_token="+r},e=>{let o=PARSE_STR(e);void 0!==o&&t(o)})}}),USOCIAL.INSTAGRAM_ACCESS_TOKEN=METHOD({run:(e,t)=>{let o,n=e.redirectURI,r=e.code;POST({isSecure:!0,host:"api.instagram.com",uri:"oauth/access_token",paramStr:o="client_id="+encodeURIComponent(NODE_CONFIG.USOCIAL.Instagram.clientId)+"&client_secret="+encodeURIComponent(NODE_CONFIG.USOCIAL.Instagram.clientSecret)+"&grant_type=authorization_code&redirect_uri="+encodeURIComponent(n)+"&code="+encodeURIComponent(r),headers:{"Content-Type":"application/x-www-form-urlencoded","Content-Length":Buffer.byteLength(o)}},e=>{t(PARSE_STR(e))})}}),USOCIAL.INSTAGRAM_GET_USER_DATA=METHOD({run:(e,t)=>{let o,n;CHECK_IS_DATA(e)!==!0?n=e:(o=e.userId,n=e.accessToken),GET({isSecure:!0,host:"api.instagram.com",uri:"v1/users/"+(void 0===o?"self":o),paramStr:"access_token="+n},e=>{let o=PARSE_STR(e);void 0!==o&&t(o.data)})}}),USOCIAL.TWITTER_ACCESS_TOKEN=METHOD({run:(e,t)=>{let o=e.token,n=e.verifier;USOCIAL.TWITTER_GET_TOKEN({url:"https://api.twitter.com/oauth/access_token",method:"POST",consumerKey:NODE_CONFIG.USOCIAL.Twitter.consumerKey,consumerSecret:NODE_CONFIG.USOCIAL.Twitter.consumerSecret,token:o,verifier:n},t)}}),USOCIAL.TWITTER_DOWNLOAD_PROFILE_IMAGE=METHOD(()=>{let e=require("http"),t=require("url");return{run:(o,n)=>{let r,c,u=o.url,i=o.path,s=t.parse(u);void 0!==n&&(CHECK_IS_DATA(n)!==!0?c=n:(r=n.error,c=n.success));let a=e.get({hostname:s.hostname===TO_DELETE?void 0:s.hostname,path:s.pathname===TO_DELETE?void 0:s.pathname,agent:new e.Agent({keepAlive:!0})},e=>{if(301===e.statusCode||302===e.statusCode)DOWNLOAD({url:e.headers.location,path:i},{success:c,error:r}),e.destroy();else{let t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{WRITE_FILE({path:i,buffer:Buffer.concat(t)},{success:c,error:r})})}});a.on("error",e=>{let t=e.toString();void 0!==r?r(t):SHOW_ERROR("USOCIAL","TWITTER_DOWNLOAD_PROFILE_IMAGE FAILED: "+t,o)})}}}),USOCIAL.TWITTER_GENERATE_AUTHORIZATION=METHOD(e=>{let t=require("crypto"),o=require("querystring"),n=(e,o,n)=>{let r=t.createHmac("sha1",e);return r.update(o),r.digest(n)};return{run:e=>{let t=e.url,r=e.method,c=void 0===e.paramStr?{}:o.parse(e.paramStr),u=e.consumerKey,i=e.consumerSecret,s=void 0===e.tokenSecret?"":e.tokenSecret,a=e.token,T=e.verifier,E=RANDOM_STR(42),O=INTEGER(Date.now()/1e3),_={oauth_consumer_key:u,oauth_nonce:E,oauth_signature_method:"HMAC-SHA1",oauth_timestamp:O,oauth_token:a,oauth_verifier:T,oauth_version:"1.0"},I=COMBINE([c,_]),S=Object.keys(I).sort(),A="",C="OAuth ";return EACH(S,(e,t)=>{void 0!==I[e]&&(A+=""===A?e+"="+encodeURIComponent(I[e]):"&"+e+"="+encodeURIComponent(I[e]))}),A=encodeURIComponent(A),EACH(_,(e,o)=>{void 0!==e&&("OAuth "===C?C+=o+'="'+encodeURIComponent(e)+'"':("oauth_signature_method"===o&&(C+=', oauth_signature="'+encodeURIComponent(n(i+"&"+s,r+"&"+encodeURIComponent(t)+"&"+A,"base64"))+'"'),C+=", "+o+'="'+encodeURIComponent(e)+'"'))}),C}}}),USOCIAL.TWITTER_GET_TOKEN=METHOD(e=>{let t=require("url"),o=require("querystring");return{run:(e,n)=>{let r,c,u=e.url,i=t.parse(u);void 0!==n&&(CHECK_IS_DATA(n)!==!0?c=n:(r=n.error,c=n.success)),POST({isSecure:"https:"===i.protocol,host:i.hostname===TO_DELETE?void 0:i.hostname,port:i.port===TO_DELETE?void 0:INTEGER(i.port),uri:i.pathname===TO_DELETE?void 0:i.pathname.substring(1),headers:{Authorization:USOCIAL.TWITTER_GENERATE_AUTHORIZATION(e)}},{error:r,success:e=>{c(o.parse(e))}})}}}),USOCIAL.TWITTER_GET_USER_DATA=METHOD({run:(e,t)=>{let o=e.userId,n=e.token,r=e.tokenSecret;GET({isSecure:!0,host:"api.twitter.com",uri:"1.1/users/show.json",paramStr:"user_id="+o,headers:{Authorization:USOCIAL.TWITTER_GENERATE_AUTHORIZATION({url:"https://api.twitter.com/1.1/users/show.json",method:"GET",paramStr:"user_id="+o,consumerKey:NODE_CONFIG.USOCIAL.Twitter.consumerKey,consumerSecret:NODE_CONFIG.USOCIAL.Twitter.consumerSecret,token:n,tokenSecret:r})}},e=>{t(PARSE_STR(e))})}}),USOCIAL.TWITTER_REQUEST_TOKEN=METHOD({run:e=>{USOCIAL.TWITTER_GET_TOKEN({url:"https://api.twitter.com/oauth/request_token",method:"POST",consumerKey:NODE_CONFIG.USOCIAL.Twitter.consumerKey,consumerSecret:NODE_CONFIG.USOCIAL.Twitter.consumerSecret},t=>{e(t.oauth_token)})}});